<div class="container">
  <div class="main-polizas">
      <div class="cotizaciones">
          <h2>
              Detalles para los Vouchers
          </h2>

          <div class="select-mail">
              <input type="checkbox"  style="margin-right: 10px;" [(ngModel)]="similarEmail" (change)="setEmails($event)"   >
              <div class="email-info">
                <span>Todos utilizan el mismo email?</span>
                <span>{{defaultEmail}}</span>
              </div>
          </div>


          <div  *ngIf="datosCotizacionMenores.length>0" class="group-cotizacion">

              <span>Menores de 75</span>
              <hr>

              <div class="list-cotizacion">
                  <ng-container *ngFor="let poliza of listPolizas" >
                          <form [formGroup]="poliza.form"*ngIf="poliza.type===1" class="cotizacion"  [class.active]="poliza.isOpen" >
                              <div class="cotizacion-header"(click)="openForm(poliza)"  >
                                  <div class="data">
                                      <div class="data-poliza">
                                          <svg  *ngIf="!poliza.form.valid; else valid"  class="warning" xmlns="http://www.w3.org/2000/svg" height="48" viewBox="0 96 960 960" width="48"><path d="M92 936q-9 0-15.652-4.125Q69.696 927.75 66 921q-4.167-6.6-4.583-14.3Q61 899 66 891l388-670q5-8 11.5-11.5T480 206q8 0 14.5 3.5T506 221l388 670q5 8 4.583 15.7-.416 7.7-4.583 14.3-3.696 6.75-10.348 10.875Q877 936 868 936H92Zm392.175-117q12.825 0 21.325-8.675 8.5-8.676 8.5-21.5 0-12.825-8.675-21.325-8.676-8.5-21.5-8.5-12.825 0-21.325 8.675-8.5 8.676-8.5 21.5 0 12.825 8.675 21.325 8.676 8.5 21.5 8.5Zm0-111q12.825 0 21.325-8.625T514 678V514q0-12.75-8.675-21.375-8.676-8.625-21.5-8.625-12.825 0-21.325 8.625T454 514v164q0 12.75 8.675 21.375 8.676 8.625 21.5 8.625Z"/></svg>
                                          <ng-template #valid>
                                              <svg    class="success" xmlns="http://www.w3.org/2000/svg" height="48" viewBox="0 96 960 960" width="48"><path d="m421 667-98-98q-9-9-22-9t-23 10q-9 9-9 22t9 22l122 123q9 9 21 9t21-9l239-239q10-10 10-23t-10-23q-10-9-23.5-8.5T635 453L421 667Zm59 309q-82 0-155-31.5t-127.5-86Q143 804 111.5 731T80 576q0-83 31.5-156t86-127Q252 239 325 207.5T480 176q83 0 156 31.5T763 293q54 54 85.5 127T880 576q0 82-31.5 155T763 858.5q-54 54.5-127 86T480 976Z"/></svg>

                                          </ng-template>
                                          <div class="data-cliente">
                                              <span>Voucher</span>
                                              <span class="detalle-poliza">Dato personales completos</span>
                                          </div>

                                      </div>

                                      <svg xmlns="http://www.w3.org/2000/svg" height="48" viewBox="0 96 960 960" width="48"><path d="M480 699q-6 0-11-2t-10-7L261 492q-8-8-7.5-21.5T262 449q10-10 21.5-8.5T304 450l176 176 176-176q8-8 21.5-9t21.5 9q10 8 8.5 21t-9.5 22L501 690q-5 5-10 7t-11 2Z"/></svg>

                                  </div>
                              </div>
                              <div class="cotizacion-main">

                                  <div class="field">
                                      <label for="nombre">Nombre(s)</label>
                                      <input type="text" formControlName="nombres" name="nombres" placeholder="Nombre(s)">
                                  </div>
                                  <div class="field">
                                      <label for="apellido">Apellido(s)</label>
                                      <input type="text"  formControlName="apellidos" id="apellidos" name="apellidos" placeholder="Apellido(s)">
                                  </div>
                                  <div class="field">
                                      <label for="age">Fecha de nacimiento</label>
                                      <input class="date-input"  [min]="fechaLimite" formControlName="age"  type="date" name="age" id="age" value="" placeholder="00/00/0000">
                                  </div>

                                  <div class="field">
                                      <label for="nombre">Nacionalidad</label>
                                      <div class="select">
                                          <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 96 960 960" width="24"><path d="M784 936 532 684q-30 24-69 38t-83 14q-109 0-184.5-75.5T120 476q0-109 75.5-184.5T380 216q109 0 184.5 75.5T640 476q0 44-14 83t-38 69l252 252-56 56ZM380 656q75 0 127.5-52.5T560 476q0-75-52.5-127.5T380 296q-75 0-127.5 52.5T200 476q0 75 52.5 127.5T380 656Z"/></svg>
                                          <select name="origen" id="origen"  formControlName="origen"  >
                                              <option value="Bolivia">Bolivia</option>
                                              <option value="Argentina">Argentina</option>
                                              <option value="Brasil">Brasil</option>
                                              <option value="Chile">Chile</option>
                                              <option value="Colombia">Colombia</option>
                                              <option value="Ecuador">Ecuador</option>
                                          </select>
                                      </div>
                                  </div>
                                  <div class="field">
                                      <label for="nombre">Genero</label>
                                      <div class="select">
                                          <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 96 960 960" width="24"><path d="M784 936 532 684q-30 24-69 38t-83 14q-109 0-184.5-75.5T120 476q0-109 75.5-184.5T380 216q109 0 184.5 75.5T640 476q0 44-14 83t-38 69l252 252-56 56ZM380 656q75 0 127.5-52.5T560 476q0-75-52.5-127.5T380 296q-75 0-127.5 52.5T200 476q0 75 52.5 127.5T380 656Z"/></svg>
                                          <select name="gender" id="gender"  formControlName="gender"  >
                                              <option value="Masculino">Masculino</option>
                                              <option value="Femenino">Femenino</option>

                                          </select>
                                      </div>
                                  </div>
                                  <div class="field">
                                    <label for="identier">Dni o Pasaporte</label>
                                    <input type="text"  formControlName="identifier"  id="identifier" name="identifier" placeholder="ABC1231415">
                                  </div>
                                  <div class="field">
                                      <label for="email"   >Correo electronico</label>
                                      <input type="email" [disabled]="emailState" formControlName="email" id="email" name="email" placeholder="email">
                                  </div>
                                  <div class="field">
                                      <label for="telf">Numero de telefono</label>
                                      <ngx-intl-tel-input
                                        [enableAutoCountrySelect]="true"
                                        [enablePlaceholder]="true"
                                        [searchCountryFlag]="true"
                                        [selectedCountryISO]="countryIso.Bolivia"
                                        [separateDialCode]="true"
                                        [formControlName]="'telf'"
                                        [customPlaceholder]="'Inserta tu numero'"
                                        [maxLength]="15"
                                        [phoneValidation]="true"
                                        name="telf"

                                      ></ngx-intl-tel-input>
                                  </div>


                              </div>
                              <!-- <div class="cotizacion-footer">
                                  <input type="checkbox" formControlName="titular"    name="titular" id="titular" value="titular">
                                  <label for="titular">Titular</label>
                              </div> -->
                          </form>


                  </ng-container>


              </div>
          </div>
          <div *ngIf="datosCotizacionMayores.length>0" class="group-cotizacion">
              <span>Mayores de 75</span>
              <hr>

              <div class="list-cotizacion">
                  <ng-container *ngFor="let poliza of listPolizas" >
                      <form [formGroup]="poliza.form"*ngIf="poliza.type===2" class="cotizacion"  [class.active]="poliza.isOpen" >
                          <div class="cotizacion-header"(click)="openForm(poliza)"  >
                              <div class="data">
                                  <div class="data-poliza">
                                      <svg  *ngIf="!poliza.form.valid; else valid"  class="warning" xmlns="http://www.w3.org/2000/svg" height="48" viewBox="0 96 960 960" width="48"><path d="M92 936q-9 0-15.652-4.125Q69.696 927.75 66 921q-4.167-6.6-4.583-14.3Q61 899 66 891l388-670q5-8 11.5-11.5T480 206q8 0 14.5 3.5T506 221l388 670q5 8 4.583 15.7-.416 7.7-4.583 14.3-3.696 6.75-10.348 10.875Q877 936 868 936H92Zm392.175-117q12.825 0 21.325-8.675 8.5-8.676 8.5-21.5 0-12.825-8.675-21.325-8.676-8.5-21.5-8.5-12.825 0-21.325 8.675-8.5 8.676-8.5 21.5 0 12.825 8.675 21.325 8.676 8.5 21.5 8.5Zm0-111q12.825 0 21.325-8.625T514 678V514q0-12.75-8.675-21.375-8.676-8.625-21.5-8.625-12.825 0-21.325 8.625T454 514v164q0 12.75 8.675 21.375 8.676 8.625 21.5 8.625Z"/></svg>
                                      <ng-template #valid>
                                          <svg    class="success" xmlns="http://www.w3.org/2000/svg" height="48" viewBox="0 96 960 960" width="48"><path d="m421 667-98-98q-9-9-22-9t-23 10q-9 9-9 22t9 22l122 123q9 9 21 9t21-9l239-239q10-10 10-23t-10-23q-10-9-23.5-8.5T635 453L421 667Zm59 309q-82 0-155-31.5t-127.5-86Q143 804 111.5 731T80 576q0-83 31.5-156t86-127Q252 239 325 207.5T480 176q83 0 156 31.5T763 293q54 54 85.5 127T880 576q0 82-31.5 155T763 858.5q-54 54.5-127 86T480 976Z"/></svg>

                                      </ng-template>
                                      <div class="data-cliente">
                                          <span>Poliza 1</span>
                                          <span class="detalle-poliza">Dato personales completos</span>
                                      </div>

                                  </div>

                                  <svg xmlns="http://www.w3.org/2000/svg" height="48" viewBox="0 96 960 960" width="48"><path d="M480 699q-6 0-11-2t-10-7L261 492q-8-8-7.5-21.5T262 449q10-10 21.5-8.5T304 450l176 176 176-176q8-8 21.5-9t21.5 9q10 8 8.5 21t-9.5 22L501 690q-5 5-10 7t-11 2Z"/></svg>

                              </div>
                          </div>
                          <div class="cotizacion-main">

                              <div class="field">
                                  <label for="nombre">Nombre(s)</label>
                                  <input type="text" formControlName="nombres" name="nombres" placeholder="Nombre(s)">
                              </div>
                              <div class="field">
                                  <label for="apellido">Apellido(s)</label>
                                  <input type="text"  formControlName="apellidos" id="apellidos" name="apellidos" placeholder="Apellido(s)">
                              </div>
                              <div class="field">
                                  <label for="age">Fecha de nacimiento</label>
                                  <input class="date-input" [max]="fechaLimite" formControlName="age"  type="date" name="age" id="age" value="" placeholder="00/00/0000">
                              </div>

                              <div class="field">
                                  <label for="nombre">Nacionalidad</label>
                                  <div class="select">
                                      <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 96 960 960" width="24"><path d="M784 936 532 684q-30 24-69 38t-83 14q-109 0-184.5-75.5T120 476q0-109 75.5-184.5T380 216q109 0 184.5 75.5T640 476q0 44-14 83t-38 69l252 252-56 56ZM380 656q75 0 127.5-52.5T560 476q0-75-52.5-127.5T380 296q-75 0-127.5 52.5T200 476q0 75 52.5 127.5T380 656Z"/></svg>
                                      <select name="origen" id="origen"  formControlName="origen"  >
                                          <option value="Bolivia">Bolivia</option>
                                          <option value="Argentina">Argentina</option>
                                          <option value="Brasil">Brasil</option>
                                          <option value="Chile">Chile</option>
                                          <option value="Colombia">Colombia</option>
                                          <option value="Ecuador">Ecuador</option>
                                      </select>
                                  </div>
                              </div>
                              <div class="field">
                                  <label for="nombre">Genero</label>
                                  <div class="select">
                                      <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 96 960 960" width="24"><path d="M784 936 532 684q-30 24-69 38t-83 14q-109 0-184.5-75.5T120 476q0-109 75.5-184.5T380 216q109 0 184.5 75.5T640 476q0 44-14 83t-38 69l252 252-56 56ZM380 656q75 0 127.5-52.5T560 476q0-75-52.5-127.5T380 296q-75 0-127.5 52.5T200 476q0 75 52.5 127.5T380 656Z"/></svg>
                                      <select name="gender" id="gender"  formControlName="gender"  >
                                          <option value="1">Masculino</option>
                                          <option value="2">Femenino</option>

                                      </select>
                                  </div>
                              </div>
                              <div class="field">
                                  <label for="identifier">Dni o Pasaporte</label>
                                  <input type="text"  formControlName="identifier"  id="identifier" name="identifier" placeholder="ABC1231415">
                              </div>
                              <div class="field">
                                  <label for="email">Correo electronico</label>
                                  <input type="email" formControlName="email" id="email" name="email" placeholder="email">
                              </div>
                              <div class="field">
                                <label for="telf">Numero de telefono</label>
                                <ngx-intl-tel-input
                                  [enableAutoCountrySelect]="true"
                                  [enablePlaceholder]="true"
                                  [searchCountryFlag]="true"
                                  [selectedCountryISO]="countryIso.Bolivia"
                                  [separateDialCode]="true"
                                  [formControlName]="'telf'"
                                  [customPlaceholder]="'Inserta tu numero'"
                                  [maxLength]="15"
                                  [phoneValidation]="true"
                                  name="telf"
                                ></ngx-intl-tel-input>
                            </div>


                          </div>
                          <!-- <div class="cotizacion-footer">
                              <input type="checkbox" formControlName="titular"    name="titular" id="titular" value="titular">
                              <label for="titular">Titular</label>
                          </div> -->
                      </form>


                  </ng-container>

              </div>
          </div>




      </div>
      <div class="carrito">

          <div class="loading" [@loadingAnimation]="hasLoaded ? 'hide' : 'show'">
              <img
              src="assets/svg/loading.svg"
              alt=""
              >
              <span>Espere un momento, cargando la informacion</span>
          </div>



          <ng-container *ngIf="hasLoaded">

              <h2>Carrito</h2>
              <span>Cantidad de dias : {{diffDays}}</span>
              <div class="listado-carrito">
                  <span class="descuento">
                      Planes
                  </span>
                  <ng-container *ngIf="datosCotizacionMenores.length>0">
                      <div class="item-carrito">
                          <span class="descripcion number">{{servicioMenores?.servicio}} * {{precioMenores.cantidadPolizas}} / {{costoMenores | number:'1.0-3'}}</span>
                          <span class="costo number" >+{{precioMenores.precioTotal | currency:'USD':'$':'1.2-2' }}...</span>

                      </div>
                  </ng-container>

                  <ng-container *ngIf="datosCotizacionMayores.length>0">
                      <div class="item-carrito">
                          <span class="descripcion number">{{servicioMayores?.servicio}} * {{precioMayores.cantidadPolizas}} / {{costoMayores | number:'1.0-3'}}</span>
                          <span class="costo number" >+{{precioMayores.precioTotal | currency:'USD':'$':'1.2-2' }}...</span>

                      </div>
                  </ng-container>

                  <hr>
                  <span class="descuento number" *ngIf="listExtras.length>0">
                      Extras
                  </span>

                  <ng-container *ngFor="let extra of dataExtra">
                      <div class="item-carrito">
                          <span class="descripcion number">{{extra.extra.beneficio}}-Cantidad: {{extra.cantidad}} </span>
                          <span class="costo number" >+{{extra.costoTotal | currency:'USD':'$':'1.2-2' }}</span>

                      </div>
                      <hr>

                  </ng-container>

                  <span class="descuento" *ngIf="listDescuentos.length>0">
                      Descuentos
                  </span>
                  <ng-container *ngFor="let descuento of listDescuentos">

                      <div class="item-carrito">
                          <span class="number" *ngIf="!descuento.cupon.nombre" >
                            Descuento nro : {{descuento.cupon.cupon_id}}
                          </span>
                          <span class="number" *ngIf="descuento.cupon.nombre">{{descuento.cupon.nombre}}</span>
                          <span class="costo number" >-{{descuento.montoTotal | currency:'USD':'$':'1.2-2' }}</span>

                      </div>
                      <hr>


                  </ng-container>

              </div>

              <div class="total">
                  <span>Total</span>
                  <p class="number">${{totalEnteros}}<span class="decimal number">{{totalDecimales}}</span> <span class="type-money">USD</span></p>
              </div>

              <div *ngIf="listPolizas.length>1; else isOnlyOne" >

                <div class="btn_select">
                  <button class="select-titular"  [class.active]="getActivePolizas()"  (click)="openHeadlines()">
                    <i class="fa-solid fa-person-circle-check fa-2xl" style="color: white; padding: 20px 0px;"></i>
                    <span style="color: white;">Seleccionar titular</span>

                  </button>
                </div>
                <span
                style="display: flex;
                width: 100%;
                text-align: center;
                color: red;"
                *ngIf="!getActivePolizas()" >
                Se requiere que se completen los detalles correspondientes de cada persona
                </span>

              </div>

              <ng-template #isOnlyOne >
                <div class="btn_select">
                  <button class="select-titular" [class.active]="getActivePolizas()"  (click)="comprobarDatos(listPolizas)" style="padding: 20px;" >
                    <i class="fa-solid fa-cart-shopping fa-2xl" style="color: white;"></i>

                  </button>
                </div>

                <span
                style="display: flex;
                width: 100%;
                text-align: center;
                color: red;"
                *ngIf="!getActivePolizas()" >
                Se requiere que se completen los detalles correspondientes de cada persona
                </span>


              </ng-template>


          </ng-container>
      </div>
  </div>
  <div class="btn_float">
    <button class="float"  (click)="toggleShoppingCart()">
      <i class="fa-solid fa-cart-shopping fa-2xl" style="color: white;"></i>

    </button>
  </div>

</div>







<!-- <data-payment></data-payment> -->
<shopping-cart-polizas [messageReady]="true"  *ngIf="shopping_cart"   (closeEvent)="toggleShoppingCart()"  (submitEvent)="closeCartOpenHeadline()" [cotizacionesMayores]="datosCotizacionMayores.length" [cotizacionesMenores]="datosCotizacionMenores.length" [dias]="diffDays" [planMayores]="servicioMayores" [planMenores]="servicioMenores" [costoMayores]="costoMayores" [costoMenores]="costoMenores" [listPolizas]="listPolizas"   ></shopping-cart-polizas>
<headline *ngIf="showHeadlines"  (closeModal)="closeHeadlines()" [listPolizas]="listPolizas" (generateSold)="comprobarDatos($event)" ></headline>
<data-payment *ngIf="makePayment && client_secret"  (closeModal)="closePayment()"  [amount]="amount"  [client_secret]="client_secret" [respString]="stringResp"   ></data-payment>
